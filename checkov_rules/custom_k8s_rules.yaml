yaml
metadata:
  id: "CUSTOM_K8S_22"
  name: "Заборона використання HostPort 22 для контейнерів"
  category: "Networking"
  guideline: "Використання hostPort 22 відкриває вузол Minikube для зовнішнього SSH-доступу. Використовуйте ClusterIP або NodePort з іншими портами."
definition:
  and:
    - cond_type: "filter"
      value: ["kubernetes_deployment", "kubernetes_pod", "kubernetes_stateful_set"]
      operator: "within"
      attribute: "resource_type"
    - cond_type: "attribute"
      attribute: "spec.template.spec.container.port.host_port" # шлях у Terraform ресурсі
      operator: "equals"
      value: 22
